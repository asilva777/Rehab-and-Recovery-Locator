<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Rehab & Recovery Locator – Philippines</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    h1 {
      text-align: center;
      background: #2d5a9b;
      color: white;
      padding: 15px;
    }
    #map {
      height: 80vh;
      width: 100%;
    }
    .search-boxes {
      display: flex;
      justify-content: center;
      padding: 10px;
      gap: 10px;
      flex-wrap: wrap;
    }
    input {
      padding: 8px;
      width: 200px;
    }
  </style>
</head>
<body>

  <h1>Rehab & Recovery Locator – Philippines</h1>

  <div class="search-boxes">
    <input type="text" id="regionInput" placeholder="Search by Region" />
    <input type="text" id="provinceInput" placeholder="Search by Province" />
    <input type="text" id="cityInput" placeholder="Search by City" />
  </div>

  <div id="map"></div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

  <script>
    const rehabCenters = [
      {
        region: "Cagayan Valley",
        province: "Isabela",
        city: "Ilagan City",
        name: "DOH Drug Abuse Treatment & Rehabilitation Center",
        address: "Centro, Brgy. San Antonio, Ilagan",
        director: "Dr. Charity I. Canapi",
        capacity: "50 (Male)",
        ownership: "GO",
        modality: "Therapeutic Community",
        contact: "0908-8134084 / 0975-2762650 / 0917-1528202",
        email: "trc_dohro2@yahoo.com.ph",
        validity: "01/01/2020 - 12/31/2022",
        lat: 17.1473,
        lng: 121.8892
      },
      {
        region: "Central Luzon",
        province: "Bataan",
        city: "Pilar",
        name: "DOH-Treatment and Rehabilitation Center Bataan",
        address: "Batangas III, Brgy. Liyang, Pilar",
        director: "Dr. Elizabeth Serrano",
        capacity: "200 (Male & Female)",
        ownership: "GO",
        modality: "Therapeutic Community",
        contact: "0999-5190930",
        email: "dohtrcbataan@yahoo.com",
        validity: "01/01/2022 - 12/31/2024",
        lat: 14.6725,
        lng: 120.5361
      },
      {
        region: "CALABARZON",
        province: "Cavite",
        city: "Imus",
        name: "San Gabriel Recovery and Treatment Center",
        address: "Barangay Langkaan",
        director: "Mr. Reynaldo Tan",
        capacity: "100 (Male & Female)",
        ownership: "PO",
        modality: "Medical & Psychosocial",
        contact: "0917-1234567",
        email: "san.gabriel.rehab@gmail.com",
        validity: "01/01/2021 - 12/31/2023",
        lat: 14.4347,
        lng: 120.9369
      },
      {
        region: "Western Visayas",
        province: "Iloilo",
        city: "Iloilo City",
        name: "Hope Recovery Center",
        address: "Brgy. San Jose",
        director: "Ms. Angela Cruz",
        capacity: "80 (Male & Female)",
        ownership: "PO",
        modality: "Therapeutic Community",
        contact: "0998-7654321",
        email: "hope.center@yahoo.com",
        validity: "01/06/2021 - 12/31/2023",
        lat: 10.7202,
        lng: 122.5621
      },
      {
        region: "Davao Region",
        province: "Davao del Sur",
        city: "Digos City",
        name: "New Life Rehabilitation Center",
        address: "Poblacion, Digos",
        director: "Dr. Mario Reyes",
        capacity: "120 (Male)",
        ownership: "GO",
        modality: "Medical",
        contact: "0939-8765432",
        email: "newlife.digos@gmail.com",
        validity: "01/03/2020 - 12/31/2022",
        lat: 6.7500,
        lng: 125.3500
      }
      // Add more centers here in the same format
    ];

    const map = L.map('map').setView([12.8797, 121.7740], 6);

    // Add OpenStreetMap tile layer
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    let markers = [];

    function addMarkers(filteredData) {
      markers.forEach(marker => map.removeLayer(marker));
      markers = [];

      filteredData.forEach(center => {
        const popupContent = `
          <strong>${center.name}</strong><br>
          <em>Director:</em> ${center.director}<br>
          ${center.address}, ${center.city}, ${center.province}<br>
          <em>Capacity:</em> ${center.capacity}<br>
          <em>Ownership:</em> ${center.ownership}<br>
          <em>Modality:</em> ${center.modality}<br>
          <em>Contact:</em> ${center.contact}<br>
          <em>Email:</em> ${center.email}<br>
          <em>Validity:</em> ${center.validity}
        `;

        const marker = L.marker([center.lat, center.lng])
          .addTo(map)
          .bindPopup(popupContent);
        markers.push(marker);
      });
    }

    function filterAndUpdate() {
      const region = document.getElementById("regionInput").value.toLowerCase();
      const province = document.getElementById("provinceInput").value.toLowerCase();
      const city = document.getElementById("cityInput").value.toLowerCase();

      const filtered = rehabCenters.filter(center =>
        center.region.toLowerCase().includes(region) &&
        center.province.toLowerCase().includes(province) &&
        center.city.toLowerCase().includes(city)
      );

      addMarkers(filtered);
    }

    document.getElementById("regionInput").addEventListener("input", filterAndUpdate);
    document.getElementById("provinceInput").addEventListener("input", filterAndUpdate);
    document.getElementById("cityInput").addEventListener("input", filterAndUpdate);

    // Load all centers initially
    addMarkers(rehabCenters);
  </script>
</body>
</html>
